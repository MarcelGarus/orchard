import
  "...core"
    Int, String, Dynamic, to_dynamic t, format Dynamic, list t t t, List t,
    iterate (List t), map (Iterator a) (\ a -> b), sum (Iterator Int),
    Iterator t, + Int Int, format Int, debug_format value:t, list t t t t t,
    any t:Type, Type, Bool, + String String, generate_array Int (\ Int -> t),
    list t, empty_list t:Type, length (Array t), Array t, < Int Int,
    push (List t) t, get_maybe (Array t) Int, else (Maybe t) t, Maybe t,
    crash String, String, as t t:Type, call (\ -> t), compare Int Int,
    mod Int Int, get (Array t) Int, >= Int Int, to_int Byte, <= Int Int, Byte,
    and Bool Bool, - Int Int, is_empty (Array t), substring String (Range Int),
    Range t, * Int Int, length String, to t t, foo a, to_byte Int,
    generate_matrix Size (\ Int Int -> t), lower_byte Int
  "...graphics" Size, Texture, Color

App =
  & render: (\ Size -> Texture)

# TODO: figure out what to do with Tasks
# Task =
#   | exit
#     print: (& message: String then: \ -> Task)
#     random: \ Int -> Task
#     read_line: \ String -> Task
# 
# print message: String then: (\ -> Task) -> Task = | print: & message then
# random then: (\ Int -> Task) -> Task = | random: then
# read_line then: (\ String -> Task) -> Task = | read_line: then

main a: Int -> App =
  & render:
      \ size: Size ->
        generate_matrix
          size
          \ x: Int y: Int ->
            & red: (x .* 25).lower_byte
              green: (y .* 25).lower_byte
              blue: 0.to_byte
              alpha: 255.to_byte
