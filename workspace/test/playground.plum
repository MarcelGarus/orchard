import "...core" Field Int List Maybe String Type Variant + - list len map sum equals

# Task =
#   | Print String (\ -> Task)
#     Exit

main a: Int -> Int =
  c = 1
  foo =
    \ b: Int = + b c
  foo a

make_list len: Int -> (List Int) =
  equals len 0
  % True: Empty
    False: More 42 (make_list (- len 1))

inc list: (List Int) -> (List Int) =
  list
  % Empty: Empty
    More item rest:
      More
        + item 1
        inc rest


to_deutsch type: Type -> String =
  type
  % Int: "Zahl"
    String: "Zeichenkette"
    Struct fields:
      "Struktur (Felder sind " | + (fields | to_deutsch) | + ")"
    Enum variants: "Enumeration (" | + (variants | to_deutsch) | + ")"
    Type: "Typ"

to_deutsch fields: (List Field) -> String =
  fields
  % Empty: "keine Felder"
    More field rest:
      rest
      % Empty: field.name
        More a b:
          field.name
          | + "("
          | + (field.type | to_deutsch)
          | + ") und "
          | + (rest | to_deutsch)

to_deutsch variants: (List Variant) -> String =
  variants
  % Empty: "keine Varianten"
    More variant rest:
      rest
      % Empty: variant.name
        More a b: variant.name | + " oder " | + (rest | to_deutsch)
