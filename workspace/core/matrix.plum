import
  "..array" Array t, generate_array Int (\ Int -> t)
  "..int" Int, * Int Int, mod Int Int, / Int Int

Size = & width: Int height: Int

Matrix t = & cells: (Array t) size: Size

generate_matrix size: Size generator: (\ Int Int -> t) -> (Matrix t)
= & cells:
      generate_array
        (size.width) .* (size.height)
        \ i: Int -> generator (i .mod (size.width)) (i ./ (size.width))
    size
